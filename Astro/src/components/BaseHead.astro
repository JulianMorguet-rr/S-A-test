---
import '../styles/reset.css';
import '../styles/global.scss';
import '../styles/transitions.scss';

import { ViewTransitions } from 'astro:transitions';
import { NoClientOnlyHint } from 'astro/dist/core/errors/errors-data';

import { urlFor } from '../lib/sanityApi.js';

export interface Props {
	title?: string;
	description?: string;
	canonicalURL?: URL | string;
	image?: string;

	globalSiteSettings?: any
}

// Hier noch SEO für spezifische page integrieren (schema muss auch noch ergänzt werden)
const globalSiteSettings = Astro.props.globalSiteSettings || {};
const title = Astro.props.globalSiteSettings?.title || 'siteSettings.title';
const description = Astro.props.globalSiteSettings?.description || 'siteSettings.description';

// console.log('title', title);
// console.log('description', description);
// const canonicalURL = Astro.props.canonicalURL || siteSettings.url;
// const image = new URL(Astro.props.image || './social.png', Astro.site);

---


<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
{ globalSiteSettings?.favicon?.asset &&
	<link rel="icon" type="image/x-icon" href={urlFor(globalSiteSettings?.favicon?.asset._ref).width(48).height(48).format('jpg').url()}>
}

<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

<!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://cdn.sanity.io/; style-src 'self' 'unsafe-inline'"> -->
<meta http-equiv="Content-Security-Policy" 
	content="
		default-src 'self' https://cdn.sanity.io/; 
		style-src 'self' 'unsafe-inline'; 
		media-src 'self' https://geschmaecker-sind-verschieden.com/ https://placehold.co;
		img-src 'self' https://cdn.sanity.io/ https://geschmaecker-sind-verschieden.com/ https://placehold.co;
		script-src 'self' https://cdn.sanity.io/ 'unsafe-inline'
	">

<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' /> 

<title>{title || 'missing Sanity title in "Page"/"Blog" and "globalSiteSettings"'}</title>
<meta name="title" content={title || 'missig Sanity title in "siteSettings"'} />
<meta name="description" content={description || 'missing Sanity description in "siteSettings"'} />

<!-- <meta name="view-transition" content="same-origin" /> -->
<ViewTransitions/>

<meta property="og:title" content={title} />
<meta property="og:description" content={description} />

<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={description} />


