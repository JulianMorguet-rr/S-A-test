---
import '../styles/reset.css';
import '../styles/global.scss';
import '../styles/transitions.scss';

import { ViewTransitions } from 'astro:transitions';
import { NoClientOnlyHint } from 'astro/dist/core/errors/errors-data';

import { urlFor } from '../lib/sanityApi.js';


export interface Props {
	title?: string;
	description?: string;
	canonicalURL?: URL | string;
	image?: string;
	seo?: any;
	globalSiteSettings?: any
	prefetch?: any;

	preload?: any;
}


// Hier noch SEO für spezifische page integrieren (schema muss auch noch ergänzt werden)
const globalSiteSettings = Astro.props.globalSiteSettings || {};
const title = Astro.props.globalSiteSettings?.title || 'siteSettings.title';
const description = Astro.props.globalSiteSettings?.description || 'siteSettings.description';

// Prefetch und Preload 
const prefetch = Astro.props.prefetch;
const preload = Astro.props.prefetch;

const { page, lang, version, path } =  Astro.params

// console.log('title', title);
// console.log('description', description);
// const canonicalURL = Astro.props.canonicalURL || siteSettings.url;
// const image = new URL(Astro.props.image || './social.png', Astro.site);


// const logPrefetch = () => {
// 	if(true) {
// 		console.log('prefetch in BaseHead.astro: ', prefetch) 
// 		console.log('page: ', page)
// 		console.log('lang: ', lang)
// 		console.log('path: ', path)
// 	} else {
// 		console.log('dont prefetch cause site is not inclded or no prefetch awailable from Props')
// 	}
// }
// logPrefetch()


// console.log('preload in BaseHead.astro: ', preload)

---


<meta charset="utf-8">
<meta name="viewport" content="width=device-width">

<link rel="icon" type="image/x-icon" href="https://cdn.sanity.io/images/tz4j4rda/production/5acb2b8efe247f3570fc56dee938a7b1443be7f4-4280x5708.jpg?rect=0,714,4280,4280&#38;w=48&#38;h=48&#38;fm=jpg">

<!-- dynamic prefetch and preload  -->
<slot></slot>

{ globalSiteSettings?.favicon?.asset &&
	(<link rel="icon" type="image/x-icon" href={urlFor(globalSiteSettings?.favicon?.asset._ref).width(48).height(48).format('jpg').url()}>)
}

<meta name="viewport" content="width=device-width">

<!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://cdn.sanity.io/; style-src 'self' 'unsafe-inline'"> -->
<meta http-equiv="Content-Security-Policy" 
	content="
		default-src 'self' https://cdn.sanity.io/; 
		style-src 'self' 'unsafe-inline'; 
		media-src 'self' https://geschmaecker-sind-verschieden.com/ https://assets.geschmaecker-sind-verschieden.com/ https://placehold.co;
		img-src 'self' https://cdn.sanity.io/ https://geschmaecker-sind-verschieden.com/ https://assets.geschmaecker-sind-verschieden.com/ https://placehold.co;
		script-src 'self' https://cdn.sanity.io/ 'unsafe-inline'
	">

<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' /> 

<title>{title || 'missing Sanity title in "Page"/"Blog" and "globalSiteSettings"'}</title>
<meta name="title" content={title || 'missig Sanity title in "siteSettings"'} />
<meta name="description" content={description || 'missing Sanity description in "siteSettings"'} />



<!-- <meta name="view-transition" content="same-origin" /> -->
<ViewTransitions/>

<meta property="og:title" content={title} />
<meta property="og:description" content={description} />

<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={description} />





