---
/*
Einige Dinge zu beachten:

Ich habe den <template>-Tag entfernt, da er in Astro nicht benötigt wird.
Ich habe die v-for-Schleife durch die JavaScript map-Funktion ersetzt.
Ich habe die :key, :href und :class Direktiven durch die entsprechenden JSX-Attribute ersetzt.
Ich habe den <style>-Block beibehalten, aber das scoped-Attribut entfernt, da Astro keine native Unterstützung für scoped Styles bietet. Du könntest jedoch eine CSS-Modul-Lösung verwenden, wenn du das benötigst.
Ich habe den Code für die Daten und Funktionen im Frontmatter-Bereich (zwischen den --- Zeilen) als Kommentar eingefügt. Du müsstest deine eigenen Daten und Funktionen importieren.
Hoffentlich hilft dir das weiter!

*/ 

import { Image } from 'astro:assets';
import { urlFor } from '../../lib/sanityApi.js';

interface NavItem {
    title: string
    slug: string
}
interface GlobalSiteSettings {
    title: string
    desciption: string
    // Favicon ist fraglich 
    favicon: {
        src: string
        svg: string
        altText: string
    }
    logo: {
        src: string
        svg: string
        altText: string
    }
}

interface Props {
    globalSiteSettings: GlobalSiteSettings
    mainMenu: {
        mainNav: Array<NavItem>
    }
    slug: string | undefined
}
// const props = defineProps({
//     siteSettings: Object as () => SiteSettings,
//     slug: String
// })




// let env = import.meta.env
// console.log('env from Header.astro: ', env)

const currentURL = Astro.request.url;

const { globalSiteSettings, mainMenu, slug } = Astro.props as Props

const mainNav: Array<NavItem> = []
const computedMainNav = () => {
    mainMenu.mainNav.map((navItem: NavItem) => {
        mainNav.push(navItem)
    })
}
computedMainNav()
---


<div class="color-overlay">
</div>

<header>
    <div class="inner">
        <a href="/" aria-label="Zur Startseite">
            {
                globalSiteSettings.logo.svg ? 
                    (<div set:html={globalSiteSettings.logo.svg}></div>)
                : globalSiteSettings.logo.src ?
                    <Image
                        src={urlFor(globalSiteSettings.logo.src).format('webp').url()} alt="Logo der Seite"
                            alt="Logo der Seite"
                        width={140}
                        height={56}
                    /> 
                :   <p>
                        {globalSiteSettings.title}
                    </p>
            }
        </a>
        
        <nav>
            {mainNav.map((nav, index) => (
                <div>
                    
                    <!--
                    <p style="color: #000;" onclick={`loadPage("${nav.slug}")`}>
                        {nav.title}    
                    </p>
                    -->
                    <a
                        href={nav.slug}
                        class={
                            (nav.slug === `/${slug}` ? 'active' : '') +
                            (`http://localhost:4321${nav.slug}` === currentURL ? 'active' : '')
                        }
                    >
                        {nav.title} 
                    </a>
                </div>
            ))}
        </nav>
    </div>
    <!-- 
    <script is:inline>
        const loadPage = (slug) => {
            console.log('slug: ', slug)
            window.open(`http://localhost:4321/${slug}`, '_self')
        }
    </script> 
    -->

</header>

<div class="header-space"></div>




<style lang="scss">
    .color-overlay {
        height: 0;
        width: 100vw;
        background: rgb(251,146,60);
        position: fixed;
        z-index: 99999;
        display: block;

        transition: height 0.3s ease-in-out;

        &.active {
            height: 100vh;

            transition: height 0.3s ease-in-out;
        }
    }


</style>






